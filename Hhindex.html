
<script>
  function search() {
    const phone = document.getElementById("phone").value.trim();
    const resultDiv = document.getElementById("result");

    if (!phone.startsWith("966")) {
      resultDiv.textContent = "يرجى إدخال رقم سعودي يبدأ بـ 966";
      return;
    }

    resultDiv.textContent = "جاري البحث...";

    const url = `https://corsproxy.io/?https://roda.website/mishkat_api.php?getName=true&phone=${phone}`;

    fetch(url)
      .then(res => res.json())
      .then(data => {
        if (data.response === "success" && Array.isArray(data.data) && data.data.length > 0) {
          // إزالة التكرارات باستخدام Set
          const uniqueNames = [...new Set(data.data.map(entry => entry.name))];
          resultDiv.innerHTML = uniqueNames.map(name => `<div style="margin:10px;padding:10px;border:1px solid #ccc;border-radius:6px;">${name}</div>`).join('');
        } else {
          resultDiv.textContent = "لم يتم العثور على اسم لهذا الرقم.";
        }
      })
      .catch(err => {
        console.error(err);
        resultDiv.textContent = "حدث خطأ أثناء الاتصال. تأكد من الاتصال بالإنترنت.";
      });
  }
</script>
